<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="SHORTCUT ICON" href="style/images/aster.ico">
		<script type="text/javascript" src="vendor/couchapp/jquery.js"></script>
		<script type="text/javascript" src="vendor/couchapp/bootstrap.js"></script>
		<script type="text/javascript" src="vendor/couchapp/jquery.jstree.js"></script>
		<script type="text/javascript" src="vendor/couchapp/jquery.cookie.js"></script>
		<script type="text/javascript" src="vendor/couchapp/jquery.hotkeys.js"></script>
		<script type="text/javascript" src="vendor/couchapp/jquery.couch.js"></script>
		<script type="text/javascript" src="vendor/couchapp/artendb.js"></script>
		<link rel="stylesheet" href="style/bootstrap.css" type="text/css"/>
		<link rel="stylesheet" href="style/artendb.css" type="text/css"/>
		<title>ArtenDb</title>
	</head>
	<body>
		<fieldset id="menu">
			<div style="display:block; clear:both;">
				<div id="Gruppe_label">Gruppe wählen:</div>
				<div id="Gruppe" class="btn-group" data-toggle="buttons-radio">
					<button class="btn btn-inverse" name="Gruppe" id="GruppeFauna" value="Fauna">Fauna</button>
					<button class="btn btn-inverse" name="Gruppe" id="GruppeFlora" value="Flora">Flora</button>
					<button class="btn btn-inverse" name="Gruppe" id="GruppeMoose" value="Moose">Moose</button>
					<button class="btn btn-inverse" name="Gruppe" id="GruppeMacromycetes" value="Macromycetes">Pilze</button>
					<button class="btn btn-inverse" name="Gruppe" id="GruppeLebensräume" value="Lebensräume">Lebensräume</button>
				</div>
			</div>
			<input class="search-query" style="width:330px; margin-bottom:5px;" type="search" id="suchen" placeholder="filtern"/>
			<div id="treeMeldung"></div>
			<div id="tree" style="width:367px; margin-bottom:5px;"></div>
		</fieldset>

		<div id="forms">
			<form id="art" class="form form-horizontal" action="#" method="get" autocomplete="off">
				
			</form>
		</div>

		<script>
			$(document).ready(function () {
				$("#forms").hide();
				if (navigator.appName === "Microsoft Internet Explorer") {
					$("#Meldung").html("Sie verwenden " + navigator.appName + ".<br><br>Leider unterstützt er nicht alle Funktionen, die ArtenDb benutzt.<br><br>Um mit ArtenDb zu arbeiten, müssen Sie <a href='http://www.google.de/chrome/'>Google Chrome</a> oder <a href='http://www.mozilla.org/de/firefox/new/'>Firefox</a> benutzen.");
					$("#Meldung").dialog({
						modal: true,
						title: "inkompatibler Browser",
						buttons: {
							Ok: function() {
								$(this).dialog("close");
							}
						}
					});
					return;
				}

				$("#suchen").hide();

				//Baum aufbauen, wenn Gruppe gewählt wird
				$("body").on("click", "[name='Gruppe']", function () {
					var Gruppe;
					Gruppe = this.value;
					erstelleBaum(Gruppe);
					$("#Gruppe_label").html("Gruppe:");
					$("#suchen").hide();
					$("#forms").hide();
					$("#suchen").val("");
					$("#tree").html("der Baum wird aufgebaut...");
				});
				
				//Suche steuern
				$("body").on("keyup click", "#suchen", function () {
					if (this.value.length > 2) {
						$("#tree").jstree("search", this.value);
					} else {
						$("#tree").jstree("clear_search");
					}
				});

				$(".form").on("keyup focus", "textarea", function () {
					FitToContent(this, document.documentElement.clientHeight);
				});

				//Klick auf Link zu Art steuern
				$(".form").on("click", ".LinkZuArtGleicherGruppe", function (event) {
					var id;
					event.preventDefault();
					id = $(this).attr("artid");
					$("#tree").jstree("clear_search");
					$("#suchen").val("");
					jQuery("#tree").jstree("deselect_all");
					jQuery("#tree").jstree("close_all", -1);
					jQuery("#tree").jstree("select_node", "#" + id);
				});
			});

			$(window).resize(function () {
				setzeFeldbreiten();
				setzeTreehoehe();
			});

		</script>
	</body>
	<div id="Meldung"></div>
</html>