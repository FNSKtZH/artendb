/*! jsUri v1.3.0-beta1 | https://github.com/derek-watson/jsUri */
(function(e){function n(e){if(e){e=decodeURIComponent(e);e=e.replace(t.pluses," ")}return e}function r(e){var n=t.uri_parser;var r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];var i=n.exec(e||"");var s={};r.forEach(function(e,t){s[e]=i[t]||""});return s}function i(e){var n,r,i,s,o,u;var a=[];if(typeof e==="undefined"||e===null||e===""){return a}if(e.indexOf("?")===0){e=e.substring(1)}r=e.toString().split(t.query_separator);for(n=0;n<r.length;n++){i=r[n];s=i.indexOf("=");if(s!==0){o=decodeURIComponent(i.substring(0,s));u=decodeURIComponent(i.substring(s+1));a.push(s===-1?[i,null]:[o,u])}}return a}function s(e){this.uriParts=r(e);this.queryPairs=i(this.uriParts.query);this.hasAuthorityPrefixUserPref=null}var t={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};if(!Array.prototype.forEach){Array.prototype.forEach=function(e,t){for(var n=0,r=this.length;n<r;++n){e.call(t||this,this[n],n,this)}}}["protocol","userInfo","host","port","path","anchor"].forEach(function(e){s.prototype[e]=function(t){if(typeof t!=="undefined"){this.uriParts[e]=t}return this.uriParts[e]}});s.prototype.hasAuthorityPrefix=function(e){if(typeof e!=="undefined"){this.hasAuthorityPrefixUserPref=e}if(this.hasAuthorityPrefixUserPref===null){return this.uriParts.source.indexOf("//")!==-1}else{return this.hasAuthorityPrefixUserPref}};s.prototype.query=function(e){var t="",n,r;if(typeof e!=="undefined"){this.queryPairs=i(e)}for(n=0;n<this.queryPairs.length;n++){r=this.queryPairs[n];if(t.length>0){t+="&"}if(r[1]===null){t+=r[0]}else{t+=r[0];t+="=";if(r[1]){t+=encodeURIComponent(r[1])}}}return t.length>0?"?"+t:t};s.prototype.getQueryParamValue=function(e){var t,n;for(n=0;n<this.queryPairs.length;n++){t=this.queryPairs[n];if(e===t[0]){return t[1]}}};s.prototype.getQueryParamValues=function(e){var t=[],n,r;for(n=0;n<this.queryPairs.length;n++){r=this.queryPairs[n];if(e===r[0]){t.push(r[1])}}return t};s.prototype.deleteQueryParam=function(e,t){var r=[],i,s,o,u;for(i=0;i<this.queryPairs.length;i++){s=this.queryPairs[i];o=n(s[0])===n(e);u=s[1]===t;if(arguments.length===1&&!o||arguments.length===2&&(!o||!u)){r.push(s)}}this.queryPairs=r;return this};s.prototype.addQueryParam=function(e,t,n){if(arguments.length===3&&n!==-1){n=Math.min(n,this.queryPairs.length);this.queryPairs.splice(n,0,[e,t])}else if(arguments.length>0){this.queryPairs.push([e,t])}return this};s.prototype.replaceQueryParam=function(e,t,r){var i=-1,s,o;if(arguments.length===3){for(s=0;s<this.queryPairs.length;s++){o=this.queryPairs[s];if(n(o[0])===n(e)&&decodeURIComponent(o[1])===n(r)){i=s;break}}this.deleteQueryParam(e,r).addQueryParam(e,t,i)}else{for(s=0;s<this.queryPairs.length;s++){o=this.queryPairs[s];if(n(o[0])===n(e)){i=s;break}}this.deleteQueryParam(e);this.addQueryParam(e,t,i)}return this};["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);s.prototype[t]=function(t){this[e](t);return this}});s.prototype.scheme=function(){var e="";if(this.protocol()){e+=this.protocol();if(this.protocol().indexOf(":")!==this.protocol().length-1){e+=":"}e+="//"}else{if(this.hasAuthorityPrefix()&&this.host()){e+="//"}}return e};s.prototype.origin=function(){var e=this.scheme();if(e=="file://"){return e+this.uriParts.authority}if(this.userInfo()&&this.host()){e+=this.userInfo();if(this.userInfo().indexOf("@")!==this.userInfo().length-1){e+="@"}}if(this.host()){e+=this.host();if(this.port()){e+=":"+this.port()}}return e};s.prototype.addTrailingSlash=function(){var e=this.path()||"";if(e.substr(-1)!=="/"){this.path(e+"/")}return this};s.prototype.toString=function(){var e,n=this.origin();if(this.path()){e=this.path();if(!(t.ends_with_slashes.test(n)||t.starts_with_slashes.test(e))){n+="/"}else{if(n){n.replace(t.ends_with_slashes,"/")}e=e.replace(t.starts_with_slashes,"/")}n+=e}else{if(this.host()&&(this.query().toString()||this.anchor())){n+="/"}}if(this.query().toString()){if(this.query().toString().indexOf("?")!==0){n+="?"}n+=this.query().toString()}if(this.anchor()){if(this.anchor().indexOf("#")!==0){n+="#"}n+=this.anchor()}return n};s.prototype.clone=function(){return new s(this.toString())};if(typeof define==="function"&&define.amd){define(function(){return s})}else if(typeof module!=="undefined"&&typeof module.exports!=="undefined"){module.exports=s}else{e.Uri=s}})(this)